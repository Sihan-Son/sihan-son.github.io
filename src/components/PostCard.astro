---
interface Props {
  title: string;
  date: Date;
  section: string;
  slug: string;
  thumbnail?: string | null;
  categories?: string[];
  tags?: string[];
  pinned?: boolean;
  variant?: 'featured' | 'large' | 'default';
}

const { title, date, section, slug, thumbnail, categories = [], tags = [], pinned = false, variant = 'default' } = Astro.props;
const href = `/${section}/${slug}/`;
const displayDate = date.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' });

const isFeatured = variant === 'featured';
const isLarge = variant === 'large';
---

<article class:list={[
  'group',
  isFeatured && 'col-span-full',
]}>
  <a href={href} class:list={[
    'block',
    isFeatured && 'md:flex md:gap-8 md:items-center',
  ]}>
    {thumbnail ? (
      <div class:list={[
        'overflow-hidden rounded-lg',
        isFeatured ? 'md:w-1/2 aspect-video' : 'aspect-video',
        isLarge && 'aspect-[16/10]',
      ]}>
        <img src={thumbnail} alt={title} class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500" loading="lazy" />
      </div>
    ) : (
      <div class:list={[
        'rounded-lg flex items-center justify-center',
        isFeatured ? 'md:w-1/2 aspect-video' : 'aspect-video',
        isLarge && 'aspect-[16/10]',
      ]} style="background-color: var(--bg-secondary);">
        <span class="font-mono text-xs uppercase tracking-widest" style="color: var(--text-muted);">{categories[0] || section}</span>
      </div>
    )}

    <div class:list={[
      'space-y-2',
      isFeatured ? 'md:w-1/2 pt-4 md:pt-0' : 'pt-4',
    ]}>
      {pinned && (
        <span class="inline-block font-mono text-xs uppercase tracking-widest px-2 py-0.5 rounded" style="background-color: var(--accent); color: white;">
          pin
        </span>
      )}
      <div class="flex items-center gap-3 font-mono text-xs tracking-wider" style="color: var(--text-muted);">
        <span class="uppercase" style="color: var(--accent-sub);">{section}</span>
        <span>&middot;</span>
        <time datetime={date.toISOString()}>{displayDate}</time>
      </div>
      <h2 class:list={[
        'font-serif font-bold leading-tight tracking-tight',
        isFeatured ? 'text-2xl md:text-3xl' : isLarge ? 'text-xl md:text-2xl' : 'text-lg',
      ]} style="color: var(--text-primary);">
        <span class="hover-underline">{title}</span>
      </h2>
      {isFeatured && categories.length > 0 && (
        <div class="flex flex-wrap gap-2 pt-1">
          {categories.map(cat => (
            <span class="font-mono text-xs tracking-wider" style="color: var(--text-muted);">/{cat.toLowerCase()}</span>
          ))}
        </div>
      )}
    </div>
  </a>
</article>
